<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TEMUR STYLE DUKONI — Minimal Do'kon</title>
  <meta name="description" content="TEMUR STYLE DUKONI — telefon aksessuarlari (minimal demo). Ikki til, savat, buyurtma, orders.json eksport." />
  <style>
    :root{ --accent:#1f6feb; --muted:#6b7280; --bg:#ffffff; --text:#111827; font-family: Arial, Helvetica, sans-serif; }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text)}
    header{display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid #eee}
    .brand{font-weight:700}
    .controls{margin-left:auto;display:flex;gap:8px;align-items:center}
    button{cursor:pointer}
    .btn{background:#fff;border:1px solid #ddd;padding:6px 10px;border-radius:6px}
    .btn-accent{background:var(--accent);color:#fff;border:none;padding:6px 10px;border-radius:6px}
    main{padding:14px;max-width:1000px;margin:0 auto}
    .search-row{display:flex;gap:8px;margin-bottom:12px}
    input[type="text"]{flex:1;padding:8px;border:1px solid #ddd;border-radius:6px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    .card{border:1px solid #eee;padding:10px;border-radius:6px;background:#fafafa;display:flex;flex-direction:column;gap:8px}
    .card img{width:100%;height:150px;object-fit:cover;border-radius:4px}
    .title{font-size:15px;font-weight:600}
    .price{font-weight:700;color:var(--accent)}
    .muted{color:var(--muted);font-size:13px}
    #cartPanel{position:fixed;right:12px;top:12px;width:320px;max-width:90vw;background:#fff;border:1px solid #eee;padding:12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);display:none;z-index:50}
    .cart-item{display:flex;gap:8px;align-items:center;padding:6px 0;border-bottom:1px dashed #f0f0f0}
    .cart-item img{width:56px;height:56px;object-fit:cover;border-radius:6px}
    #modalRoot{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.35);align-items:center;justify-content:center;z-index:80}
    .modal{background:#fff;padding:14px;border-radius:8px;max-width:560px;width:94%}
    .field{display:flex;flex-direction:column;margin-bottom:8px}
    label{font-size:13px;color:var(--muted);margin-bottom:4px}
    input,textarea,select{padding:8px;border:1px solid #ddd;border-radius:6px}
    footer{padding:12px;text-align:center;color:var(--muted);font-size:13px;margin-top:20px}
    .admin-row{display:flex;gap:8px;align-items:center;margin-bottom:12px}
    @media (max-width:520px){
      .grid{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
      .card img{height:120px}
    }
  </style>
</head>
<body>

  <header>
    <div class="brand" id="brandName">TEMUR STYLE DUKONI</div>
    <div class="controls">
      <div id="langLabel" style="font-size:13px;color:var(--muted)">UZ</div>
      <button class="btn" id="langBtn">Рус</button>
      <button class="btn" id="openCartBtn">Savat (<span id="cartCount">0</span>)</button>
    </div>
  </header>

  <main>
    <div class="admin-row">
      <!-- Admin: download orders button -->
      <button class="btn" id="downloadOrdersBtn">Buyurtmalarni yuklab olish (orders.json)</button>
      <div style="flex:1"></div>
      <button class="btn" id="clearOrdersBtn">Buyurtmalarni o'chirish (local)</button>
    </div>

    <div class="search-row">
      <input type="text" id="searchInput" placeholder="Mahsulot nomi yoki izoh qidiring...">
      <button class="btn" id="searchBtn">Qidir</button>
      <button class="btn-accent" id="viewAllBtn">Hammasini ko'rish</button>
    </div>

    <section>
      <div class="grid" id="productsGrid" aria-live="polite"></div>
    </section>
  </main>

  <!-- Cart panel -->
  <div id="cartPanel" role="dialog" aria-label="Savat">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div style="font-weight:700" id="cartTitle">Savat</div>
      <div><button class="btn" id="closeCartBtn">Yopish</button></div>
    </div>
    <div id="cartItems" style="max-height:320px;overflow:auto"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;border-top:1px solid #f2f2f2;padding-top:8px">
      <div style="font-weight:700">Jami: <span id="cartTotal">0</span> so'm</div>
      <div>
        <button class="btn" id="clearCartBtn">Tozalash</button>
        <button class="btn-accent" id="checkoutBtn">Buyurtma</button>
      </div>
    </div>
  </div>

  <!-- Modal root -->
  <div id="modalRoot" aria-hidden="true"></div>

  <footer>
    © <span id="year"></span> TEMUR STYLE DUKONI — Demo. (Orders lokal saqlanadi; eksport tugmasi mavjud)
  </footer>

<script>
/* ========== Minimal shop JS (TEMUR STYLE DUKONI) ========== */
/* PRODUCTS: telefon aksessuarlari namunalari.
   JOY BO'SH: kiyim-kechak uchun joy qoldirildi — quyida comment bilan belgilangan.
*/
const PRODUCTS = [
  {id:1, uz:"Powerbank 10000mAh", ru:"Powerbank 10000mAh", price:120000, desc_uz:"Tez zaryadlash, 10000mAh", desc_ru:"Быстрая зарядка, 10000mAh", img:"https://i.imgur.com/1A0aX6H.jpg"},
  {id:2, uz:"Quloqchin Simsiz (Bluetooth)", ru:"Беспроводные наушники", price:159000, desc_uz:"Bluetooth 5.0, shovqinni bostirish", desc_ru:"Bluetooth 5.0, шумоподавление", img:"https://i.imgur.com/6Y2KXq4.jpg"},
  {id:3, uz:"Telefon qopqog'i (Case)", ru:"Чехол для телефона", price:35000, desc_uz:"Silikon, himoya uchun", desc_ru:"Силиконовый, для защиты", img:"https://i.imgur.com/7w0XQ0y.jpg"},
  {id:4, uz:"Tempered glass (Ekran himoyasi)", ru:"Защитное стекло", price:25000, desc_uz:"3 qatlamli himoya", desc_ru:"3 слоя защиты", img:"https://i.imgur.com/8hYv9Rk.jpg"},
  {id:5, uz:"USB-C kabel (2m)", ru:"USB-C кабель (2м)", price:18000, desc_uz:"Tez zaryadlash, mustahkam", desc_ru:"Быстрая зарядка, прочный", img:"https://i.imgur.com/4VQ7sNa.jpg"},
  {id:6, uz:"Avto zaryadlovchi (Car Charger)", ru:"Автомобильное зарядное устройство", price:49000, desc_uz:"Fast Charge, 2 port", desc_ru:"Fast Charge, 2 порта", img:"https://i.imgur.com/9Zb2K1H.jpg"}
  /* JOY BO'SH: kiyim-kechak mahsulotlarini shu yerga qo'shishingiz mumkin.
     format misol: {id:7, uz:"Futbolka Oq", ru:"Футболка белая", price:80000, desc_uz:"...", desc_ru:"...", img:"https://..."}
  */
];

/* Config & keys */
let LANG = 'uz'; // default language
const CART_KEY = 'temur_style_cart_v1';
const ORDERS_KEY = 'temur_style_orders_v1';

/* Helpers */
function $(s){ return document.querySelector(s); }
function money(n){ return Number(n).toLocaleString('uz-UZ'); }
function loadCart(){ try{const r=localStorage.getItem(CART_KEY); return r?JSON.parse(r):{} }catch(e){return{}} }
function saveCart(cart){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); renderCartUI(); }
function cartCount(cart){ return Object.values(cart).reduce((s,i)=>s+i.qty,0); }
function cartTotal(cart){ return Object.values(cart).reduce((s,i)=>s + i.qty * i.price, 0); }

/* Render products */
const productsGrid = $('#productsGrid');
function renderProducts(list){
  productsGrid.innerHTML = '';
  (list||PRODUCTS).forEach(p=>{
    const title = LANG==='uz'?p.uz:p.ru;
    const desc = LANG==='uz'?p.desc_uz:p.desc_ru;
    const el = document.createElement('div'); el.className='card';
    el.innerHTML = `
      <img src="${p.img}" alt="${title}" onerror="this.style.objectFit='contain'">
      <div class="title">${title}</div>
      <div class="price">${money(p.price)} so'm</div>
      <div class="muted">${desc}</div>
      <div style="margin-top:auto;display:flex;gap:8px">
        <button class="btn" onclick="showDetails(${p.id})">${LANG==='uz'?'Ko\\'rish':'Посмотреть'}</button>
        <button class="btn-accent" onclick="addToCart(${p.id})">${LANG==='uz'?'Savatga qo\\'shish':'В корзину'}</button>
      </div>
    `;
    productsGrid.appendChild(el);
  });
}

/* Search & view all */
$('#searchBtn').addEventListener('click', ()=>{
  const q = $('#searchInput').value.trim().toLowerCase();
  if(!q){ renderProducts(PRODUCTS); return; }
  const filtered = PRODUCTS.filter(p=>{
    const txt = (p.uz + ' ' + p.ru + ' ' + p.desc_uz + ' ' + p.desc_ru).toLowerCase();
    return txt.includes(q);
  });
  renderProducts(filtered);
});
$('#viewAllBtn').addEventListener('click', ()=> renderProducts(PRODUCTS));

/* Cart functions */
function addToCart(id){
  const cart = loadCart();
  if(!cart[id]) cart[id] = {id:id, qty:0, price: PRODUCTS.find(x=>x.id==id).price};
  cart[id].qty += 1;
  saveCart(cart);
  updateCartCount();
  openCart();
}
function updateQty(id, delta){
  const cart = loadCart();
  if(!cart[id]) return;
  cart[id].qty += delta;
  if(cart[id].qty <= 0) delete cart[id];
  saveCart(cart);
}
function removeFromCart(id){
  const cart = loadCart(); if(cart[id]) delete cart[id]; saveCart(cart);
}
function clearCart(){ localStorage.removeItem(CART_KEY); renderCartUI(); updateCartCount(); }

/* Cart UI */
function renderCartUI(){
  const cart = loadCart();
  const itemsEl = $('#cartItems'); itemsEl.innerHTML = '';
  const keys = Object.keys(cart);
  if(keys.length===0){ itemsEl.innerHTML = `<div class="muted">${LANG==='uz'?'Savat bo\\'sh':'Корзина пуста'}</div>`; }
  else {
    keys.forEach(k=>{
      const it = cart[k]; const p = PRODUCTS.find(x=>x.id==it.id);
      const title = LANG==='uz'?p.uz:p.ru;
      const node = document.createElement('div'); node.className='cart-item';
      node.innerHTML = `
        <img src="${p.img}" alt="${title}" onerror="this.style.objectFit='contain'">
        <div style="flex:1">
          <div style="font-weight:700">${title}</div>
          <div class="muted">${money(p.price)} so'm</div>
        </div>
        <div style="text-align:right">
          <div style="display:flex;gap:6px;justify-content:flex-end;align-items:center">
            <button class="btn" onclick="updateQty(${it.id}, -1)">-</button>
            <div style="min-width:24px;text-align:center">${it.qty}</div>
            <button class="btn" onclick="updateQty(${it.id}, 1)">+</button>
          </div>
          <div style="margin-top:6px"><button class="btn" onclick="removeFromCart(${it.id})">${LANG==='uz'?'O\\'chirish':'Удалить'}</button></div>
        </div>
      `;
      itemsEl.appendChild(node);
    });
  }
  $('#cartTotal').textContent = money(cartTotal(cart));
  updateCartCount();
}
function updateCartCount(){ const cart = loadCart(); $('#cartCount').textContent = cartCount(cart); }

/* Cart panel controls */
function openCart(){ $('#cartPanel').style.display='block'; renderCartUI(); }
function closeCart(){ $('#cartPanel').style.display='none'; }
$('#openCartBtn').addEventListener('click', openCart);
$('#closeCartBtn').addEventListener('click', closeCart);
$('#clearCartBtn').addEventListener('click', clearCart);

/* Details modal */
function showDetails(id){
  const p = PRODUCTS.find(x=>x.id==id);
  const title = LANG==='uz'?p.uz:p.ru; const desc = LANG==='uz'?p.desc_uz:p.desc_ru;
  $('#modalRoot').style.display='flex';
  $('#modalRoot').innerHTML = `<div class="modal" role="dialog">
    <div style="display:flex;gap:12px;align-items:flex-start">
      <img src="${p.img}" alt="${title}" style="width:45%;height:140px;object-fit:cover;border-radius:6px">
      <div style="flex:1">
        <h3 style="margin:0">${title}</h3>
        <div class="muted" style="margin-top:6px">${desc}</div>
        <div style="font-weight:700;margin-top:8px">${money(p.price)} so'm</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button class="btn-accent" onclick="addToCart(${p.id}); closeModal();">${LANG==='uz'?'Savatga qo\\'shish':'В корзину'}</button>
          <button class="btn" onclick="closeModal()">${LANG==='uz'?'Yopish':'Закрыть'}</button>
        </div>
      </div>
    </div>
  </div>`;
}
function closeModal(){ $('#modalRoot').style.display='none'; $('#modalRoot').innerHTML=''; }

/* Checkout & orders (saved to localStorage, with export) */
$('#checkoutBtn').addEventListener('click', ()=>{
  const cart = loadCart(); if(Object.keys(cart).length===0){ alert(LANG==='uz'?'Savat bo\\'sh':'Корзина пуста'); return; }
  $('#modalRoot').style.display='flex';
  $('#modalRoot').innerHTML = `<div class="modal" role="dialog">
    <h3>${LANG==='uz'?'Buyurtma':'Заказ'}</h3>
    <div class="field"><label>${LANG==='uz'?'Ism va familiya':'Имя и фамилия'}</label><input id="o_name"></div>
    <div class="field"><label>${LANG==='uz'?'Telefon':'Телефон'}</label><input id="o_phone" placeholder="+998..."></div>
    <div class="field"><label>${LANG==='uz'?'Manzil':'Адрес'}</label><input id="o_addr"></div>
    <div style="font-weight:700;margin-top:6px">${LANG==='uz'?'To\\'lov (demo)':'Оплата (демо)'}</div>
    <div style="display:flex;gap:8px;margin-top:6px">
      <button class="btn" onclick="simulatePay('payme')">Payme</button>
      <button class="btn" onclick="simulatePay('click')">Click</button>
      <button class="btn" onclick="simulatePay('card')">Card</button>
    </div>
    <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
      <button class="btn" onclick="closeModal()">${LANG==='uz'?'Bekor':'Отмена'}</button>
      <button class="btn-accent" onclick="placeOrder()">${LANG==='uz'?'Buyurtmani jo\\'natish':'Отправить заказ'}</button>
    </div>
  </div>`;
});

function simulatePay(method){
  const phone = document.getElementById('o_phone')?.value || '';
  if(!phone){ alert(LANG==='uz'?'Telefon raqamini kiriting':'Пожалуйста, введите телефон'); return; }
  alert((LANG==='uz'?'To\\'lov simulyatsiyasi: ':'Симуляция оплаты: ') + method.toUpperCase() + '\\n' + (LANG==='uz'?'Demo faqat.':'Демо режим.'));
}

function placeOrder(){
  const name = document.getElementById('o_name')?.value?.trim() || '';
  const phone = document.getElementById('o_phone')?.value?.trim() || '';
  const addr = document.getElementById('o_addr')?.value?.trim() || '';
  if(!name || !phone || !addr){ alert(LANG==='uz'?'Iltimos barcha maydonlarni to\\'ldiring':'Пожалуйста, заполните все поля'); return; }
  const order = {
    id: 'ORD' + Date.now(),
    name, phone, addr, cart: loadCart(), total: cartTotal(loadCart()), lang: LANG, created: new Date().toISOString()
  };
  // Save orders to localStorage
  try{
    const existing = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
    existing.push(order);
    localStorage.setItem(ORDERS_KEY, JSON.stringify(existing));
  }catch(e){}
  // clear cart
  localStorage.removeItem(CART_KEY);
  renderCartUI(); updateCartCount();
  closeModal();
  alert(LANG==='uz'?'Buyurtma qabul qilindi! Tez orada siz bilan bog\\'lanamiz.':'Заказ принят! Скоро с вами свяжутся.');
}

/* Orders export / clear (admin) */
$('#downloadOrdersBtn').addEventListener('click', ()=>{
  try{
    const orders = JSON.parse(localStorage.getItem(ORDERS_KEY) ||