<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>TEMUR STYLE DUKONI</title>
  <meta name="description" content="TEMUR STYLE ‚Äî telefon aksessuarlari (dark).">
  <style>
    :root{
      --bg:#000; --text:#f8f8f8; --muted:#9aa0a6;
      --yellow:#ffcc00; --blue:#198cff;
      font-family: Inter, Arial, Helvetica, sans-serif;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
    header{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #111}
    .brand{font-weight:800;color:var(--yellow);letter-spacing:0.4px}
    .controls{display:flex;gap:8px;align-items:center}
    button{cursor:pointer;border:none;border-radius:8px;padding:8px 12px;font-weight:700}
    .btn-yellow{background:var(--yellow);color:#000}
    .btn-blue{background:var(--blue);color:#fff}
    main{padding:14px;max-width:1000px;margin:0 auto}
    .search-row{display:flex;gap:8px;margin-top:8px}
    input[type="text"]{flex:1;padding:10px;border-radius:8px;border:1px solid #222;background:#070707;color:var(--text)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin-top:14px}
    .card{background:#070707;border:1px solid #111;padding:12px;border-radius:10px;display:flex;flex-direction:column}
    .card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
    .title{font-weight:700;margin-top:10px;font-size:15px}
    .price{color:var(--yellow);font-weight:800;margin-top:6px}
    .muted{color:var(--muted);font-size:13px;margin-top:6px}
    #cartPanel{position:fixed;right:12px;top:12px;width:360px;max-width:92vw;background:#070707;border:1px solid #111;padding:12px;border-radius:10px;display:none;z-index:60}
    .cart-item{display:flex;gap:10px;align-items:center;padding:8px 0;border-bottom:1px dashed #111}
    .cart-item img{width:60px;height:60px;object-fit:cover;border-radius:8px}
    .small{font-size:13px;color:var(--muted)}
    footer{padding:12px;text-align:center;color:var(--muted);font-size:13px;margin-top:18px;border-top:1px solid #0a0a0a}
    @media(max-width:600px){
      .card img{height:120px}
      #cartPanel{width:92vw}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">TEMUR STYLE DUKONI</div>
    <div class="controls">
      <button id="langBtn" class="btn-blue">–†—É—Å</button>
      <button id="cartBtn" class="btn-yellow">üõí <span id="cartCount">0</span></button>
    </div>
  </header>

  <main>
    <div class="search-row">
      <input id="searchInput" type="text" placeholder="Mahsulot qidiring... (masalan: quloqchin, powerbank)">
      <button id="searchBtn" class="btn-blue">Qidir</button>
      <button id="clearSearchBtn" class="btn">Tozalash</button>
    </div>

    <div class="grid" id="productGrid" aria-live="polite"></div>
  </main>

  <div id="cartPanel" role="dialog" aria-label="Savat">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div style="font-weight:800" id="cartTitle">Savat</div>
      <div><button class="btn-blue" onclick="closeCart()">‚úñ</button></div>
    </div>

    <div id="cartItems" style="max-height:320px;overflow:auto;margin-top:10px"></div>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
      <div style="font-weight:800">Jami: <span id="cartTotal">0</span> so'm</div>
      <div style="display:flex;gap:8px">
        <button class="btn" id="clearCartBtn">Tozalash</button>
        <button class="btn-yellow" id="checkoutBtn">Buyurtma</button>
      </div>
    </div>
  </div>

  <footer>¬© <span id="year"></span> TEMUR STYLE DUKONI ‚Äî demo</footer>

<script>
/* ===== STORAGE KEYS ===== */
const PRODUCTS_KEY = 'temur_products';
const CART_KEY = 'temur_cart';
const ORDERS_KEY = 'temur_orders';

/* ===== DEFAULT SAMPLE PRODUCTS (applies only if none saved via admin) ===== */
const SAMPLE_PRODUCTS = [
  {id: 'p1', name_uz:'Powerbank 10000mAh', name_ru:'Powerbank 10000mAh', price:120000, desc_uz:'Tez zaryadlovchi 10000mAh', desc_ru:'–ë—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞ 10000mAh', img:'https://i.imgur.com/1A0aX6H.jpg'},
  {id: 'p2', name_uz:'Simsiz quloqchin', name_ru:'–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏', price:159000, desc_uz:'Bluetooth 5.0, qulay', desc_ru:'Bluetooth 5.0, —É–¥–æ–±–Ω–æ', img:'https://i.imgur.com/6Y2KXq4.jpg'},
  {id: 'p3', name_uz:'Telefon qopqog\'i', name_ru:'–ß–µ—Ö–æ–ª –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞', price:35000, desc_uz:'Silikon himoya', desc_ru:'–°–∏–ª–∏–∫–æ–Ω–æ–≤–∞—è –∑–∞—â–∏—Ç–∞', img:'https://i.imgur.com/7w0XQ0y.jpg'},
  {id: 'p4', name_uz:'Ekran himoyasi (Tempered)', name_ru:'–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ', price:25000, desc_uz:'3 qatlamli himoya', desc_ru:'3 —Å–ª–æ—è –∑–∞—â–∏—Ç—ã', img:'https://i.imgur.com/8hYv9Rk.jpg'}
];

/* ===== UTILITIES ===== */
function $(s){return document.querySelector(s)}
function money(n){return Number(n).toLocaleString('uz-UZ')}
function loadProducts(){ try{ const p=JSON.parse(localStorage.getItem(PRODUCTS_KEY)||'null'); return p && p.length? p : SAMPLE_PRODUCTS }catch(e){return SAMPLE_PRODUCTS} }
function saveProducts(p){ localStorage.setItem(PRODUCTS_KEY, JSON.stringify(p)) }
function loadCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY)||'{}') }catch(e){return {}} }
function saveCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)) }
function loadOrders(){ try{ return JSON.parse(localStorage.getItem(ORDERS_KEY)||'[]') }catch(e){return [] } }
function saveOrders(o){ localStorage.setItem(ORDERS_KEY, JSON.stringify(o)) }

/* ===== STATE ===== */
let LANG = 'uz' // 'uz' or 'ru'

/* ===== RENDER PRODUCTS + SEARCH ===== */
function renderProducts(list){
  const grid = $('#productGrid');
  grid.innerHTML = '';
  list.forEach(p=>{
    const title = LANG==='uz'?p.name_uz:p.name_ru;
    const desc = LANG==='uz'?p.desc_uz:p.desc_ru;
    const div = document.createElement('div'); div.className='card';
    div.innerHTML = `
      <img src="${p.img}" alt="${title}">
      <div class="title">${title}</div>
      <div class="price">${money(p.price)} so'm</div>
      <div class="muted">${desc}</div>
      <div style="margin-top:auto;display:flex;gap:8px;">
        <button class="btn-blue" onclick="showDetails('${p.id}')">${LANG==='uz'?'Ko\\'rish':'–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å'}</button>
        <button class="btn-yellow" onclick="addToCart('${p.id}')">${LANG==='uz'?'Savatga qo\\'shish':'–í –∫–æ—Ä–∑–∏–Ω—É'}</button>
      </div>
    `;
    grid.appendChild(div);
  });
}

function initRender(){
  const prods = loadProducts();
  renderProducts(prods);
  updateCartCount();
}

/* search handlers */
$('#searchBtn').addEventListener('click', ()=>{
  const q = $('#searchInput').value.trim().toLowerCase();
  doSearch(q);
});
$('#clearSearchBtn').addEventListener('click', ()=>{
  $('#searchInput').value = '';
  renderProducts(loadProducts());
});
$('#searchInput').addEventListener('keyup', (e)=>{
  if(e.key === 'Enter'){ doSearch(e.target.value.trim().toLowerCase()) }
});
function doSearch(q){
  if(!q) return renderProducts(loadProducts());
  const prods = loadProducts().filter(p=>{
    const text = (p.name_uz + ' ' + p.name_ru + ' ' + p.desc_uz + ' ' + p.desc_ru).toLowerCase();
    return text.includes(q);
  });
  renderProducts(prods);
}

/* ===== CART ===== */
function addToCart(id){
  const cart = loadCart();
  if(!cart[id]) cart[id] = {id:id, qty:0, price: (loadProducts().find(p=>p.id===id)||{}).price || 0};
  cart[id].qty += 1;
  saveCart(cart);
  updateCartCount();
  openCart();
}
function updateQty(id, delta){
  const cart = loadCart();
  if(!cart[id]) return;
  cart[id].qty += delta;
  if(cart[id].qty <= 0) delete cart[id];
  saveCart(cart);
  renderCart();
  updateCartCount();
}
function removeFromCart(id){
  const cart = loadCart();
  if(cart[id]) delete cart[id];
  saveCart(cart);
  renderCart();
  updateCartCount();
}
function clearCart(){
  localStorage.removeItem(CART_KEY);
  renderCart();
  updateCartCount();
}

/* cart UI */
function renderCart(){
  const cart = loadCart();
  const items = $('#cartItems');
  items.innerHTML = '';
  const products = loadProducts();
  let total = 0;
  Object.values(cart).forEach(it=>{
    const p = products.find(x=>x.id===it.id);
    if(!p) return;
    total += it.qty * p.price;
    const title = LANG==='uz'?p.name_uz:p.name_ru;
    const node = document.createElement('div'); node.className='cart-item';
    node.innerHTML = `
      <img src="${p.img}" alt="${title}">
      <div style="flex:1">
        <div style="font-weight:700">${title}</div>
        <div class="small">${money(p.price)} so'm</div>
      </div>
      <div style="text-align:right">
        <div style="display:flex;gap:6px;justify-content:flex-end;align-items:center">
          <button class="btn-blue" onclick="updateQty('${it.id}', -1)">-</button>
          <div style="min-width:26px;text-align:center">${it.qty}</div>
          <button class="btn-blue" onclick="updateQty('${it.id}', 1)">+</button>
        </div>
        <div style="margin-top:6px"><button class="btn" onclick="removeFromCart('${it.id}')">${LANG==='uz'?'O\\'chirish':'–£–¥–∞–ª–∏—Ç—å'}</button></div>
      </div>
    `;
    items.appendChild(node);
  });
  $('#cartTotal').textContent = money(total);
}

/* cart panel controls */
function openCart(){ $('#cartPanel').style.display = 'block'; renderCart(); }
function closeCart(){ $('#cartPanel').style.display = 'none'; }
$('#cartBtn').addEventListener('click', openCart);
$('#clearCartBtn').addEventListener('click', clearCart);

/* checkout - demo saves order to localStorage orders list */
$('#checkoutBtn').addEventListener('click', ()=>{
  const cart = loadCart();
  if(Object.keys(cart).length === 0){ alert(LANG==='uz'?'Savat bo\\'sh':'–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞'); return; }
  // simple checkout prompt (demo)
  const name = prompt(LANG==='uz'?'Ism va familiya':'–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è'); if(!name) return;
  const phone = prompt(LANG==='uz'?'Telefon raqam (+998...)':'–¢–µ–ª–µ—Ñ–æ–Ω'); if(!phone) return;
  const addr = prompt(LANG==='uz'?'Manzil':'–ê–¥—Ä–µ—Å'); if(!addr) return;
  const orders = loadOrders();
  const order = {id: 'ORD'+Date.now(), name, phone, addr, items: cart, total: (()=>{return Object.values(cart).reduce((s,i)=>s + i.qty * i.price,0)})(), lang: LANG, created: new Date().toISOString()};
  orders.push(order);
  saveOrders(orders);
  localStorage.removeItem(CART_KEY);
  renderCart();
  updateCartCount();
  alert(LANG==='uz'?'Buyurtma qabul qilindi!':'–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!');
});

/* details modal simple */
function showDetails(id){
  const p = loadProducts().find(x=>x.id===id);
  if(!p) return;
  const title = LANG==='uz'?p.name_uz:p.name_ru;
  const desc = LANG==='uz'?p.desc_uz:p.desc_ru;
  const html = `<div style="padding:12px;color:var(--text)">
    <h3>${title}</h3>
    <img src="${p.img}" style="width:100%;height:220px;object-fit:cover;border-radius:8px"/>
    <p class="muted">${desc}</p>
    <p style="font-weight:800">${money(p.price)} so'm</p>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button class="btn-yellow" onclick="addToCart('${p.id}'); closeModal();">${LANG==='uz'?'Savatga qo\\'shish':'–í –∫–æ—Ä–∑–∏–Ω—É'}</button>
      <button class="btn" onclick="closeModal()">${LANG==='uz'?'Yopish':'–ó–∞–∫—Ä—ã—Ç—å'}</button>
    </div>
  </div>`;
  openModal(html);
}
function openModal(innerHTML){ // simple modal using cartPanel area overlay
  const overlay = document.createElement('div');
  overlay.style.position='fixed'; overlay.style.inset='0'; overlay.style.background='rgba(0,0,0,0.6)'; overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center'; overlay.style.zIndex='9999';
  const box = document.createElement('div'); box.style.maxWidth='520px'; box.style.width='92%'; box.style.borderRadius='10px'; box.style.overflow='hidden'; box.style.background='#070707'; box.style.border='1px solid #111';
  box.innerHTML = innerHTML;
  overlay.appendChild(box);
  overlay.onclick = ()=>{ document.body.removeChild(overlay) };
  box.onclick = (e)=> e.stopPropagation();
  document.body.appendChild(overlay);
}
function closeModal(){ const overlays = [...document.querySelectorAll('body > div')]; for(const o of overlays){ if(o.style && o.style.zIndex==='9999') o.remove(); } }

/* language toggle */
$('#langBtn').addEventListener('click', ()=>{
  LANG = LANG === 'uz' ? 'ru' : 'uz';
  $('#langBtn').textContent = LANG==='uz' ? '–†—É—Å' : 'UZ';
  $('#cartTitle').textContent = LANG==='uz' ? 'Savat' : '–ö–æ—Ä–∑–∏–Ω–∞';
  renderProducts(loadProducts());
  renderCart();
});

/* init */
document.getElementById('year').textContent = new Date().getFullYear();
initRender();
updateCartCount();
</script>
</body>
</html>