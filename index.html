<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minimal Do'kon — Demo</title>
  <meta name="description" content="Minimal dizaynli onlayn do'kon (demo). Mahsulotlar, savat, buyurtma, ikki til.">
  <style>
    /* Minimalist — only essential styles */
    :root{ --accent:#1f6feb; --muted:#6b7280; --bg:#ffffff; --text:#111827; font-family: Arial, Helvetica, sans-serif; }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text)}
    header{display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid #eee}
    .brand{font-weight:700}
    .controls{margin-left:auto;display:flex;gap:8px;align-items:center}
    button{cursor:pointer}
    .btn{background:#fff;border:1px solid #ddd;padding:6px 10px;border-radius:6px}
    .btn-accent{background:var(--accent);color:#fff;border:none;padding:6px 10px;border-radius:6px}
    main{padding:14px;max-width:1000px;margin:0 auto}
    .search-row{display:flex;gap:8px;margin-bottom:12px}
    input[type="text"]{flex:1;padding:8px;border:1px solid #ddd;border-radius:6px}
    /* products */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    .card{border:1px solid #eee;padding:10px;border-radius:6px;background:#fafafa;display:flex;flex-direction:column;gap:8px}
    .card img{width:100%;height:150px;object-fit:cover;border-radius:4px}
    .title{font-size:15px;font-weight:600}
    .price{font-weight:700;color:var(--accent)}
    .muted{color:var(--muted);font-size:13px}
    /* cart simple panel */
    #cartPanel{position:fixed;right:12px;top:12px;width:320px;max-width:90vw;background:#fff;border:1px solid #eee;padding:12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);display:none;z-index:50}
    .cart-item{display:flex;gap:8px;align-items:center;padding:6px 0;border-bottom:1px dashed #f0f0f0}
    .cart-item img{width:56px;height:56px;object-fit:cover;border-radius:6px}
    .cart-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}
    /* modal */
    #modalRoot{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.35);align-items:center;justify-content:center;z-index:80}
    .modal{background:#fff;padding:14px;border-radius:8px;max-width:560px;width:94%}
    .field{display:flex;flex-direction:column;margin-bottom:8px}
    label{font-size:13px;color:var(--muted);margin-bottom:4px}
    input,textarea,select{padding:8px;border:1px solid #ddd;border-radius:6px}
    footer{padding:12px;text-align:center;color:var(--muted);font-size:13px;margin-top:20px}
    /* responsive tiny */
    @media (max-width:520px){
      .grid{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
      .card img{height:120px}
    }
  </style>
</head>
<body>

  <header>
    <div class="brand" id="brandName">Minimal Do'kon</div>

    <div class="controls">
      <div id="langLabel" style="font-size:13px;color:var(--muted)">UZ</div>
      <button class="btn" id="langBtn">Рус</button>
      <button class="btn" id="openCartBtn">Savat (<span id="cartCount">0</span>)</button>
    </div>
  </header>

  <main>
    <div class="search-row">
      <input type="text" id="searchInput" placeholder="Mahsulot nomi yoki izoh qidiring...">
      <button class="btn" id="searchBtn">Qidir</button>
      <button class="btn-accent" id="viewAllBtn">Hammasini ko'rish</button>
    </div>

    <section>
      <div class="grid" id="productsGrid" aria-live="polite">
        <!-- products inserted by JS -->
      </div>
    </section>
  </main>

  <!-- Cart panel (minimal) -->
  <div id="cartPanel" role="dialog" aria-label="Savat">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div style="font-weight:700" id="cartTitle">Savat</div>
      <div><button class="btn" id="closeCartBtn">Yopish</button></div>
    </div>
    <div id="cartItems" style="max-height:320px;overflow:auto"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;border-top:1px solid #f2f2f2;padding-top:8px">
      <div style="font-weight:700">Jami: <span id="cartTotal">0</span> so'm</div>
      <div>
        <button class="btn" id="clearCartBtn">Tozalash</button>
        <button class="btn-accent" id="checkoutBtn">Buyurtma</button>
      </div>
    </div>
  </div>

  <!-- Modal root (checkout & details) -->
  <div id="modalRoot" aria-hidden="true"></div>

  <footer>
    Demo — minimal dizayn. Iltimos, haqiqiy to'lov integratsiyasi uchun server va kalitlar qo'shing.
  </footer>

<script>
/* ===== Minimal functional JS (bilingual, products, cart, checkout demo) ===== */

/* ------------ DATA (customize as needed) -------------- */
/* Minimalist site — edit products array below if you want */
const PRODUCTS = [
  {id:1, uz:"Futbolka — Oq", ru:"Футболка — Белая", price:80000, desc_uz:"100% paxta.", desc_ru:"100% хлопок.", img:"https://i.imgur.com/dVQ9pQp.jpg"},
  {id:2, uz:"Shim — Klassik", ru:"Брюки — Классические", price:150000, desc_uz:"Ofis uchun.", desc_ru:"Для офиса.", img:"https://i.imgur.com/1PjVxLq.jpg"},
  {id:3, uz:"Kurtka — Yazgi", ru:"Куртка — Летняя", price:220000, desc_uz:"Yengil va chidamli.", desc_ru:"Лёгкая и прочная.", img:"https://i.imgur.com/W7iM9Ew.jpg"},
  {id:4, uz:"Sumka — Street", ru:"Сумка — Street", price:120000, desc_uz:"Kundalik foydalanish.", desc_ru:"Для повседневного использования.", img:"https://i.imgur.com/RPiJXzS.jpg"}
];

/* ------------ State and helpers -------------- */
let LANG = 'uz'; // 'uz' or 'ru'
const CART_KEY = 'minimal_shop_cart_v1';

function money(n){ return Number(n).toLocaleString('uz-UZ'); }
function loadCart(){ try{ const r=localStorage.getItem(CART_KEY); return r?JSON.parse(r):{} }catch(e){return{}} }
function saveCart(cart){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); renderCartUI(); }

/* ------------ Render products (minimal markup) -------------- */
const productsGrid = document.getElementById('productsGrid');

function renderProducts(list){
  productsGrid.innerHTML = '';
  list.forEach(p=>{
    const title = (LANG==='uz'?p.uz:p.ru);
    const desc = (LANG==='uz'?p.desc_uz:p.desc_ru);
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <img src="${p.img}" alt="${title}" onerror="this.style.objectFit='contain'">
      <div class="title">${title}</div>
      <div class="price">${money(p.price)} so'm</div>
      <div class="muted">${desc}</div>
      <div style="margin-top:auto;display:flex;gap:8px">
        <button class="btn" data-id="${p.id}" onclick="showDetails(${p.id})">${LANG==='uz'?'Ko\'rish':'Посмотреть'}</button>
        <button class="btn-accent" onclick="addToCart(${p.id})">${LANG==='uz'?'Savatga qo\'shish':'В корзину'}</button>
      </div>
    `;
    productsGrid.appendChild(div);
  });
}

/* ------------ Search / controls -------------- */
document.getElementById('searchBtn').addEventListener('click', ()=>{
  const q = document.getElementById('searchInput').value.trim().toLowerCase();
  if(!q){ renderProducts(PRODUCTS); return; }
  const filtered = PRODUCTS.filter(p=>{
    const text = (p.uz + ' ' + p.ru + ' ' + p.desc_uz + ' ' + p.desc_ru).toLowerCase();
    return text.includes(q);
  });
  renderProducts(filtered);
});
document.getElementById('viewAllBtn').addEventListener('click', ()=> renderProducts(PRODUCTS));

/* ------------ Cart functions -------------- */
function addToCart(id){
  const cart = loadCart();
  if(!cart[id]) cart[id] = {id:id, qty:0, price: PRODUCTS.find(x=>x.id==id).price};
  cart[id].qty += 1;
  saveCart(cart);
  updateCartCount();
  openCart();
}
function updateQty(id, delta){
  const cart = loadCart();
  if(!cart[id]) return;
  cart[id].qty += delta;
  if(cart[id].qty <= 0) delete cart[id];
  saveCart(cart);
}
function removeFromCart(id){
  const cart = loadCart();
  if(cart[id]) delete cart[id];
  saveCart(cart);
}
function clearCart(){
  localStorage.removeItem(CART_KEY);
  renderCartUI();
  updateCartCount();
}

/* ------------ Cart UI -------------- */
function renderCartUI(){
  const cartItems = document.getElementById('cartItems');
  const cart = loadCart();
  cartItems.innerHTML = '';
  const keys = Object.keys(cart);
  if(keys.length === 0){
    cartItems.innerHTML = `<div class="muted">${LANG==='uz'?'Savat bo\'sh':'Корзина пуста'}</div>`;
  } else {
    keys.forEach(k=>{
      const it = cart[k];
      const p = PRODUCTS.find(x=>x.id==it.id);
      const title = LANG==='uz'?p.uz:p.ru;
      const node = document.createElement('div');
      node.className = 'cart-item';
      node.innerHTML = `
        <img src="${p.img}" alt="${title}" onerror="this.style.objectFit='contain'">
        <div style="flex:1">
          <div style="font-weight:700">${title}</div>
          <div class="muted">${money(p.price)} so'm</div>
        </div>
        <div style="text-align:right">
          <div style="display:flex;gap:6px;justify-content:flex-end;align-items:center">
            <button class="btn" onclick="updateQty(${it.id}, -1)">-</button>
            <div style="min-width:24px;text-align:center">${it.qty}</div>
            <button class="btn" onclick="updateQty(${it.id}, 1)">+</button>
          </div>
          <div style="margin-top:6px"><button class="btn" onclick="removeFromCart(${it.id})">${LANG==='uz'?'O\'chirish':'Удалить'}</button></div>
        </div>
      `;
      cartItems.appendChild(node);
    });
  }
  document.getElementById('cartTotal').textContent = money(cartTotal(cart));
  updateCartCount();
}
function cartTotal(cart){
  return Object.values(cart).reduce((s,i)=>s + i.qty * i.price, 0);
}
function updateCartCount(){
  const cart = loadCart();
  const count = Object.values(cart).reduce((s,i)=>s+i.qty,0);
  document.getElementById('cartCount').textContent = count;
}

/* ------------ Cart panel show/hide -------------- */
const cartPanel = document.getElementById('cartPanel');
function openCart(){ cartPanel.style.display = 'block'; renderCartUI(); }
function closeCart(){ cartPanel.style.display = 'none'; }
document.getElementById('openCartBtn').addEventListener('click', openCart);
document.getElementById('closeCartBtn').addEventListener('click', closeCart);
document.getElementById('clearCartBtn').addEventListener('click', ()=>{ clearCart(); });

/* ------------ Details & Checkout modal (minimal) -------------- */
const modalRoot = document.getElementById('modalRoot');

function showDetails(id){
  const p = PRODUCTS.find(x=>x.id==id);
  const title = LANG==='uz'?p.uz:p.ru;
  const desc = LANG==='uz'?p.desc_uz:p.desc_ru;
  modalRoot.style.display = 'flex';
  modalRoot.innerHTML = `<div class="modal" role="dialog" aria-label="${title}">
    <div style="display:flex;gap:12px;align-items:flex-start">
      <img src="${p.img}" alt="${title}" style="width:45%;height:140px;object-fit:cover;border-radius:6px">
      <div style="flex:1">
        <h3 style="margin:0">${title}</h3>
        <div class="muted" style="margin-top:6px">${desc}</div>
        <div style="font-weight:700;margin-top:8px">${money(p.price)} so'm</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button class="btn-accent" onclick="addToCart(${p.id}); closeModal();">${LANG==='uz'?'Savatga qo\'shish':'В корзину'}</button>
          <button class="btn" onclick="closeModal()">${LANG==='uz'?'Yopish':'Закрыть'}</button>
        </div>
      </div>
    </div>
  </div>`;
}
function closeModal(){ modalRoot.style.display = 'none'; modalRoot.innerHTML = ''; }

/* Checkout: simple form -> save order to localStorage (demo) */
document.getElementById('checkoutBtn').addEventListener('click', ()=>{
  const cart = loadCart(); if(Object.keys(cart).length===0){ alert(LANG==='uz'?'Savat bo\'sh':'Корзина пуста'); return; }
  modalRoot.style.display = 'flex';
  modalRoot.innerHTML = `<div class="modal" role="dialog">
    <h3>${LANG==='uz'?'Buyurtma':'Заказ'}</h3>
    <div class="field"><label>${LANG==='uz'?'Ism va familiya':'Имя и фамилия'}</label><input id="o_name"></div>
    <div class="field"><label>${LANG==='uz'?'Telefon':'Телефон'}</label><input id="o_phone" placeholder="+998..."></div>
    <div class="field"><label>${LANG==='uz'?'Manzil':'Адрес'}</label><input id="o_addr"></div>
    <div class="field"><label>${LANG==='uz'?'Izoh (majburiy emas)':'Примечание (необязательно)'}</label><textarea id="o_note" rows="2"></textarea></div>

    <div style="font-weight:700;margin-bottom:6px">${LANG==='uz'?'To\'lov (demo)':'Оплата (демо)'}</div>
    <div style="display:flex;gap:8px;margin-bottom:12px">
      <button class="btn" onclick="simulatePay('payme')">Payme</button>
      <button class="btn" onclick="simulatePay('click')">Click</button>
      <button class="btn" onclick="simulatePay('card')">Card</button>
    </div>

    <div style="display:flex;justify-content:flex-end;gap:8px">
      <button class="btn" onclick="closeModal()">${LANG==='uz'?'Bekor':'Отмена'}</button>
      <button class="btn-accent" onclick="placeOrder()">${LANG==='uz'?'Buyurtmani jo\'natish':'Отправить заказ'}</button>
    </div>
  </div>`;
});

function simulatePay(method){
  const phone = document.getElementById('o_phone')?.value || '';
  if(!phone){ alert(LANG==='uz'?'Telefon raqamini kiriting':'Введите телефон'); return; }
  alert((LANG==='uz'?'To\'lov simulyatsiyasi: ':'Симуляция оплаты: ') + method.toUpperCase() + '\n' + (LANG==='uz'?'Demo faqat.':'Демо режим.'));
}

function placeOrder(){
  const name = document.getElementById('o_name')?.value?.trim() || '';
  const phone = document.getElementById('o_phone')?.value?.trim() || '';
  const addr = document.getElementById('o_addr')?.value?.trim() || '';
  if(!name || !phone || !addr){ alert(LANG==='uz'?'Iltimos barcha maydonlarni to\'ldiring':'Пожалуйста, заполните все поля'); return; }
  const order = {
    id: 'ORD' + Date.now(),
    name, phone, addr,
    note: document.getElementById('o_note')?.value || '',
    cart: loadCart(),
    total: cartTotal(loadCart()),
    lang: LANG,
    created: new Date().toISOString()
  };
  // save orders array in localStorage (demo)
  try{
    const key = 'minimal_shop_orders_v1';
    const existing = JSON.parse(localStorage.getItem(key) || '[]');
    existing.push(order);
    localStorage.setItem(key, JSON.stringify(existing));
  }catch(e){}
  // clear cart and show confirmation
  localStorage.removeItem(CART_KEY);
  renderCartUI();
  closeModal();
  alert(LANG==='uz'?'Buyurtma qabul qilindi! Tez orada siz bilan bog\'lanamiz.':'Заказ принят! Скоро с вами свяжутся.');
}

/* ------------ Language toggle (minimal) -------------- */
document.getElementById('langBtn').addEventListener('click', ()=>{
  LANG = (LANG === 'uz') ? 'ru' : 'uz';
  document.getElementById('langLabel').textContent = (LANG === 'uz') ? 'UZ' : 'RU';
  document.getElementById('langBtn').textContent = (LANG === 'uz') ? 'Рус' : 'UZ';
  document.getElementById('brandName').textContent = (LANG === 'uz') ? 'Minimal Do\\'kon' : 'Минимал Магазин';
  renderProducts(PRODUCTS);
  renderCartUI();
});

/* ------------ Init -------------- */
renderProducts(PRODUCTS);
renderCartUI();
updateCartCount();

/* Expose some functions to inline handlers */
window.addToCart = addToCart;
window.updateQty = updateQty;
window.removeFromCart = removeFromCart;
window.showDetails = showDetails;
window.closeModal = closeModal;
window.simulatePay = simulatePay;
window.placeOrder = placeOrder;
</script>

</body>
</html>